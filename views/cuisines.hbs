<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Cuisines List</title>
    <meta name="viewport" content="initial-scale=1, shrink-to-fit=yes">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous"/>
    {{!-- <link rel="stylesheet" type="text/css" href="extensions/filter-control/bootstrap-table-filter-control.css"/> --}}
    <link rel="stylesheet" href="/css/style.css" type="text/css"/>
</head>

<script language="Javascript" src='./js/cuisines_ShowHideCRUD.js'></script>

<body onload='browseCuisines()'>

{{!-- The Data from our database --}}

{{!-- Create a table --}}
<div id="top">
<h1 align="center">Cuisines</h1>

<nav class="navbar navbar-expand-sm navbar-dark bg-dark">
  <a class="navbar-brand" href="/">Grubmaster</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav">
      <a class="nav-item nav-link" href="/">Home<span class="sr-only"></span></a>
      <a class="nav-item nav-link" href="/restaurants">Restaurants</a>
      <a class="nav-item nav-link active" href="/cuisines">Cuisines</a>
      <a class="nav-item nav-link" href="/cities">Cities</a>
      <a class="nav-item nav-link" href="/users">Users</a>
      <a class="nav-item nav-link" href="/reviews">Reviews</a>
      <a class="nav-item nav-link" href="/restaurant_has_cuisines">Restaurants' Cuisines</a>
    </div>

  </div>
</nav>

</div>
<p>&nbsp;</p>

<div id="browse-cuisines">
    <p><button type="button" class="btn btn-primary" onClick="newCuisine()">Add a New Cuisine</button></p>
    
    <table id="cuisines-table" 
    class="table table-striped table-bordered table-hover" 
    align="center"
    data-search="true"
    >

    {{!-- Header section --}}
    <thead class="justify-content-center" align="center">

        {{!-- For just the first row, we print each key of the row object as a header cell so we
        know what each column means when the page renders --}}
        <tr id="headers">
            <th class="header" scope="col">ID</th>
            <th class="header" scope="col">Cuisine Name</th>
            <th class="header" scope="col">Edit</th>
        </tr>
    </thead>

    {{!-- Body section --}}
    <tbody>
        {{#each data}}
        <tr align="center" data-value={{this.cuisine_id}}>
            <td id="cuisine_id">{{this.cuisine_id}}</td>
            <td id="cuisine_name">{{this.cuisine_name}}</td>
            <td><a href="/cuisines/edit_cuisine.html/{{this.cuisine_id}}" class="btn btn-warning active" role="button" aria-pressed="true">Edit</a></td>
        </tr>
        {{/each}}
    </tbody>
    </table>

</div>
<p>&nbsp;</p>

<div class="form-fields" id="search-cuisine" style="display: block">
    <h2>Search for a Cuisine below.</h2>
    <p>Search by Cuisine name using the field below. Partial names are OK too!</p>
    <form id="search-cuisine-form" method='GET' action='/cuisines'>
        <label for="input-cuisine-name">Search by Cuisine Name: </label>
        <input type="text" name="cuisine_name" id="input-cuisine-name-search">
        
        <input type="submit">
        <a href="/cuisines"><input type="button" value="Reset"></a>
    </form>
</div>
<p>&nbsp;</p>

<div class="form-fields" id="add-cuisine">
    <h2>Add a new cuisine: </h2>
    <p>To add a new cuisine, please enter the information below and click 'Submit'! </p> 
    <p><small>Note: * indicates a required field.</small></p>

    <form id="add-cuisine-form" method="POST" action="/cuisines/add-cuisine-form">
        <p><label for="input-cuisine">* Cuisine Name:</label>
        <input type="text" name="input-cuisine-name" id="input-cuisine-name" required></p> 

        <p><input type="submit" id="addCuisine" value="Submit" onClick="return validateForm();" class="btn btn-primary"> 
        <input type="button" value="Cancel" onClick="browseCuisines()" class="btn btn-secondary"></p>
        
    </form>
</div>

<p>&nbsp;</p>

<script>
    // Data Validation for required fields Source: https://stackoverflow.com/questions/57087145/check-if-all-required-fields-are-filled-in-a-specific-div 
    // Checks if every required field is filled out before sending alert
    function validateForm() {
        let requiredFields = document.getElementById('add-cuisine-form')
            .querySelectorAll('[required]')
        let valid = []; 
        requiredFields.forEach((element) => {
            if (element.value !== "") {
                valid.push(true)
            } else {valid.push(false)}
        })
        let checker = arr => arr.every(v => v === true); 
        if (checker(valid)) {
            alert('Successfully added new cuisine!')
        }
    }
</script>

</body> 
</html>