<!-- users.hbs -->

[ <a href="/">Home</a> | <a href="/restaurants">Restaurants</a> | <a href="/users">Users</a> | <a href="/cities">Cities</a> | <a href="/reviews">Reviews</a> | <a href="/restaurant_has_cuisines">Restaurants' Cuisines</a>]

<head>
    <meta charset="utf-8">
    <title>Users</title>
    <meta name="viewport" content="initial-scale=1, shrink-to-fit=yes">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous"/>
    {{!-- <link rel="stylesheet" type="text/css" href="extensions/filter-control/bootstrap-table-filter-control.css"/> --}}
    <link rel="stylesheet" href="/css/style.css" type="text/css"/>
</head>

<script language="Javascript" src='./js/users_ShowHideCRUD.js'></script>
<body onload='browseUsers()'>

<div id="browse-users">

    <p><button href="/add-user" onClick="newUser()">Add a New User</button></p>
    <p><button href="/update-user" onClick="updateUser()">Update a User</button></p>

{{!-- Create a table --}}
<table id="users-table" class="table table-striped table-bordered table-hover" align="center" data-search="true">

    {{!-- Header section --}}
    <thead>
        <tr id="headers">
            <th class="header" scope="col">ID</th>
            <th class="header" scope="col">First Name</th>
            <th class="header" scope="col">Last Name</th>
            <th class="header" scope="col">E-mail Address</th>
            <th class="header" scope="col">City</th>
            <th class="header" scope="col" colspan="2">Actions</th>
        </tr>
    </thead>

    {{!-- Body section --}}
    <tbody>
        {{!-- For each row, print the id, name, website, email and city --}}
        {{#each data}}
        <tr>
            <td>{{this.user_id}}</td>
            <td>{{this.user_first_name}}</td>
            <td>{{this.user_last_name}}</td>
            {{#if this.user_email}}
                <td>{{this.user_email}}</td>
                    {{else}}
                <td>NULL</td>
            {{/if}}
            <td>{{this.user_city_id}}</td>
            <td><a href="/users/edit_user.html/{{this.user_id}}"><button>Edit</button></a></td>
            <td><button onclick="deleteUser({{this.user_id}})">Delete</button></td>
        </tr>
        {{/each}}
    </tbody>
</table>
</div>

<p>&nbsp;</p>
<div id="search-user" style="display: block">
<h2>Search Users</h2>
<form id="search-person-html" method='GET' action='/users'>
    <label for="input-lname">Search by Last Name: </label>
    <input type="text" name="user_last_name" id="input-lname-html-search">
    <input type="submit">
    <a href='/users'><button>Reset</button></a>
</form>
</div>
<p>&nbsp;</p>

<script src="./js/delete_user.js"></script>

<div id="add-user" style="display: block">
    <form method="POST" id="add-user-form-ajax">
        <h2>Add a User</h2>
        <p>Add a new user to the database.</p> 
        <fieldset class="fields">
        <form class="p-1 mb-1 bg-light border-bottom">            
            <label>First Name*</label> <input type="text" name="first_name" id="first_name">
            <label>Last Name*</label> <input type="text" name="last_name" id="last_name">
            <label>E-mail Address</label> <input type="text" name="email_address" id="email_address">
            <label>City*</label> 
                <select name="city" id="city">
                    <option value="">Select a City</option>
                    {{#each cities}}
                    <option value="{{this.city_id}}">{{this.city_name}}</option>
                    {{/each}}
                </select>
        </fieldset>
        <input type="submit" id="add-user-form-ajax" value="Add User">
    </form> 
</div><!-- Add New User -->

<script src="./js/add_user.js"></script>

<p>&nbsp;</p>

<div id="update-user" style="display: block">
    <form id="update-user-form-ajax">
    <h2>Update A User's Information</h2>
    <p>User the search function to locate the correct ID, then update a User's information using this form.</p>
        <fieldset class="fields">
            <form class="p-1 mb-1 bg-light border-bottom">
            <label>User ID*</label> 
                <select name="user_id" id="selected_user_id" onChange="formFill()">
                    <option value="">Select a User ID</option>
                    {{#each data}}
                    <option value="{{this.user_id}}">{{this.user_id}}</option>
                    {{/each}}
                </select>             
            <label>First Name*</label> <input type="text" name="first_name" id="update_first_name" value="First Name">
            <label>Last Name*</label> <input type="text" name="last_name" id="update_last_name">
            <label>E-mail Address*</label> <input type="text" name="email_address" id="update_email_address">
            <label>City*</label> 
                <select name="city" id="update_city">
                    <option value="">Select a City</option>
                    {{#each cities}}
                    <option value="{{this.city_id}}">{{this.city_name}}</option>
                    {{/each}}
                </select>
        </fieldset>
        <input type="submit" id="update-user-form-ajax" value="Update User">
    </form><!-- Update User -->
</div>

<script src="./js/update_user.js"></script>

<script><!-- Update from Ed Discussions example by TA James Cole -->
    function formFill() {
        console.log('test');
        console.log("first_name");
        document.getElementById("update_first_name").value = first_name;
    }
</script>

